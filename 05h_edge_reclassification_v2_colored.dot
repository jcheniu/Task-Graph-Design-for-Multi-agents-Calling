digraph MCMKillerWorkflowV2Classified {
    graph [rankdir=LR, fontname="Microsoft YaHei", fontsize=12, labelloc="t",
           label="MCM-Killer Workflow (146 edges, protocol-completed, v2 classes color-coded)",
           bgcolor="white", splines=true, overlap=false];
    node [shape=box, style="rounded,filled", fillcolor="#F8FBFF", color="#5B8DB8", fontname="Microsoft YaHei", fontsize=10];
    edge [fontname="Microsoft YaHei", fontsize=9, arrowsize=0.8];

    // Original nodes
    APC [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="asset_pre_check pass?"];
    B01 [shape=note, fillcolor="#F2F2F2", color="#888888", label="规则：0.2 被 0.1 阻塞\n0.1 未完成不得进入 0.2"];
    CMP [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="7F compile success?"];
    CONT [shape=box, fillcolor="#E9FCEB", color="#56A15F", label="继续当前主线/进入下一阶段"];
    D5 [shape=diamond, fillcolor="#EAF7FF", color="#4A93C9", label="Phase 5 依赖判定"];
    DC [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="paper.tex 与 CSV 一致?"];
    DEF [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="DEFCON Trigger?"];
    DM [shape=diamond, fillcolor="#F5F0FF", color="#8D6AC8", label="Decision Matrix\nHIGH=>Must Accept\nLOW+HighCost+LowUrgency=>May Reject"];
    EDR [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="editor 页数审查通过?"];
    EM [shape=diamond, fillcolor="#FFECEC", color="#C95A5A", label="Convergence Failure?\nR-hat>1.3 或 >12h不收敛"];
    ESC [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="环境问题升级\n(缺包/字体等)"];
    FIX [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="从CSV重生成表格"];
    FP [shape=box, fillcolor="#E9FCEB", color="#56A15F", label="Force PASS(记录局限)"];
    I5 [shape=box, fillcolor="#EAF7FF", color="#4A93C9", label="INDEPENDENT\nworkers并行训练"];
    J1 [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="拒绝次数 < 6?"];
    J2 [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="6-10 且 score>=95?"];
    J3 [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label=">10 次?"];
    M5 [shape=box, fillcolor="#EAF7FF", color="#4A93C9", label="MIXED\n分批训练"];
    NOTE [shape=note, fillcolor="#F2F2F2", color="#888888", label="说明:\n1) 主线必须严格串行\n2) 所有阶段都经过 Time Gate\n3) validator REQUIRE_REWIND 为强制回退\n4) 其余rewind建议走决策矩阵\n5) 图中已覆盖主要循环/跳转/旁路"];
    NX [shape=box, fillcolor="#E9FCEB", color="#56A15F", label="允许进入下一阶段"];
    P0 [label="0\nProblem Understanding"];
    P01 [label="0.1\nExternal Resource Processing"];
    P02 [label="0.2\nKnowledge Retrieval"];
    P05 [label="0.5\nMethodology Gate"];
    P1 [label="1\nModel Design"];
    P10 [label="10\nFinal Review"];
    P11 [label="11\nSelf-Evolution"];
    P15 [label="1.5\nTime Validation"];
    P2 [label="2\nFeasibility Check"];
    P3 [label="3\nData Processing"];
    P4 [label="4\nCode Translation"];
    P45 [label="4.5\nImplementation Fidelity"];
    P5 [label="5\nModel Training"];
    P55 [label="5.5\nData Authenticity"];
    P58 [label="5.8\nInsight Extraction"];
    P6 [label="6\nVisualization"];
    P65 [label="6.5\nVisual Quality Gate"];
    P75 [label="7.5\nLaTeX Gate"];
    P7A [label="7A\nFramework"];
    P7B [label="7B\nModels"];
    P7C [label="7C\nResults"];
    P7D [label="7D\nAnalysis"];
    P7E [label="7E\nConclusions"];
    P7F [label="7F\nCompile"];
    P8 [label="8\nSummary"];
    P9 [label="9\nPolish"];
    P91 [label="9.1\nMock Judging"];
    P95 [label="9.5\nEditor Feedback"];
    PAUSE [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="Pause 当前phase计时"];
    RESUME [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="Resume 原phase计时"];
    RET [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="修复并重试 (<=3)"];
    RJ [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="继续拒绝/返修循环"];
    RR [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="REJECT + FORCE RERUN\n(--rerun)\n读取 previous_output 改进"];
    S5 [shape=box, fillcolor="#EAF7FF", color="#4A93C9", label="SEQUENTIAL\nworkers顺序训练"];
    SUG [shape=diamond, fillcolor="#F5F0FF", color="#8D6AC8", label="收到回退建议?\n(非validator强制)"];
    TG [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="Time Gate\ncumulative_duration >= MIN ?"];
    TV [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="time_validator\nAPPROVE?"];
    VFIX [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="回调visualizer修复资产"];
    VR [shape=diamond, fillcolor="#FFECEC", color="#C95A5A", label="validator 发出\nREQUIRE_REWIND?"];
    W5 [shape=box, fillcolor="#EAF7FF", color="#4A93C9", label="等待所有worker完成"];
    WREV [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="writer 修订当前子阶段"];

    // Protocol completion nodes (from workspace/2025_C/CLAUDE.md)
    AGENT_RUN [shape=box, fillcolor="#EEF5FF", color="#6D8FB8", label="agent run"];
    ALT [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="alternative approach"];
    ANY_PHASE [shape=box, fillcolor="#F2F2F2", color="#888888", label="any phase"];
    ARTIFACT_CHECK [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="results_{i}.csv
all exist?"];
    CHUNK [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="smaller chunks"];
    CONSULT [shape=diamond, fillcolor="#F5F0FF", color="#8D6AC8", label="consultation export
checkpoint"];
    DIRECTOR [shape=box, fillcolor="#EEF5FF", color="#6D8FB8", label="director"];
    EXT_RES [shape=box, fillcolor="#EEF5FF", color="#6D8FB8", label="external_resources/past_work"];
    FILE_BAN [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="file-ban enforcement"];
    KNOWN_ISSUES [shape=note, fillcolor="#F2F2F2", color="#888888", label="known_issues.md"];
    MANIFEST7 [shape=note, fillcolor="#F2F2F2", color="#888888", label="VERSION_MANIFEST.json"];
    PREV_OUT [shape=note, fillcolor="#F2F2F2", color="#888888", label="read previous_output_path
and improve"];
    RERUN_CMD [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="python tools/time_tracker.py
start --rerun"];
    REVERIFY_ALL [shape=box, fillcolor="#F5F0FF", color="#8D6AC8", label="all agents re-verify"];
    REWORK_DONE [shape=box, fillcolor="#EEF5FF", color="#6D8FB8", label="rework done"];
    SIMPLE [shape=box, fillcolor="#FFECEC", color="#C95A5A", label="simplified prompt"];
    TIMEOUT3 [shape=diamond, fillcolor="#FFECEC", color="#C95A5A", label="3x timeout?"];
    TOOL_AUDIT [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="tool uses > 0?"];
    TRUST_VERIFY [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="independent verification"];
    TV_CALL [shape=diamond, fillcolor="#FFF7E6", color="#D39B2A", label="per-phase
time_validator call"];

    // Colored edges from updated 05d_edge_reclassification_v2.csv
    P0 -> P01 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E001 | ProgressTransitionObject | progress:linear"];
    P01 -> P02 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E002 | ProgressTransitionObject | progress:linear"];
    P02 -> P05 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E003 | ProgressTransitionObject | progress:linear"];
    P05 -> P1 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E004 | ProgressTransitionObject | progress:linear"];
    P1 -> P15 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E005 | ProgressTransitionObject | progress:linear"];
    P15 -> P2 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E006 | ProgressTransitionObject | progress:linear"];
    P2 -> P3 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E007 | ProgressTransitionObject | progress:linear"];
    P3 -> P4 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E008 | ProgressTransitionObject | progress:linear"];
    P4 -> P45 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E009 | ProgressTransitionObject | progress:linear"];
    P45 -> P5 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E010 | ProgressTransitionObject | progress:linear"];
    P5 -> P55 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E011 | ProgressTransitionObject | progress:linear"];
    P55 -> P58 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E012 | ProgressTransitionObject | progress:linear"];
    P58 -> P6 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E013 | ProgressTransitionObject | progress:linear"];
    P6 -> P65 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E014 | ProgressTransitionObject | progress:linear"];
    P65 -> P7A [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E015 | ProgressTransitionObject | progress:linear"];
    P7A -> P7B [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E016 | ProgressTransitionObject | progress:linear"];
    P7B -> P7C [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E017 | ProgressTransitionObject | progress:linear"];
    P7C -> P7D [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E018 | ProgressTransitionObject | progress:linear"];
    P7D -> P7E [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E019 | ProgressTransitionObject | progress:linear"];
    P7E -> P7F [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E020 | ProgressTransitionObject | progress:linear"];
    P7F -> P75 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E021 | ProgressTransitionObject | progress:linear"];
    P75 -> P8 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E022 | ProgressTransitionObject | progress:linear"];
    P8 -> P9 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E023 | ProgressTransitionObject | progress:linear"];
    P9 -> P91 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E024 | ProgressTransitionObject | progress:linear"];
    P91 -> P95 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E025 | ProgressTransitionObject | progress:linear"];
    P95 -> P10 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E026 | ProgressTransitionObject | progress:linear"];
    P10 -> P11 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E027 | ProgressTransitionObject | progress:linear"];
    TG -> RR [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E028 | ExceptionTransitionObject | exception:block", label="No"];
    RR -> TG [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E029 | LoopTransitionObject | loop:rerun", label="循环"];
    TG -> TV [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E030 | GateTransitionObject | gate:handoff:time_validator", label="Yes"];
    TV -> RR [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E031 | ExceptionTransitionObject | exception:block", label="REJECT"];
    TV -> NX [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E032 | ProgressTransitionObject | progress:released", label="APPROVE"];
    NX -> CONT [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E033 | ProgressTransitionObject | progress:released"];
    P01 -> B01 [color="#2AA198", fontcolor="#2AA198", style="dashed", penwidth=2.0, tooltip="E034 | SyncTransitionObject | sync:dependency", arrowhead=none];
    B01 -> P02 [color="#2AA198", fontcolor="#2AA198", style="dashed", penwidth=2.0, tooltip="E035 | SyncTransitionObject | sync:dependency", label="解锁后"];
    VR -> PAUSE [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E036 | RollbackTransitionObject | rollback:trigger", label="Yes"];
    VR -> CONT [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E037 | ProgressTransitionObject | progress:continued", label="No"];
    PAUSE -> RW1 [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E038 | RollbackTransitionObject | rollback:dispatch"];
    PAUSE -> RW3 [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E039 | RollbackTransitionObject | rollback:dispatch"];
    PAUSE -> RW4 [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E040 | RollbackTransitionObject | rollback:dispatch"];
    PAUSE -> RW5 [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E041 | RollbackTransitionObject | rollback:dispatch"];
    RW1 -> RESUME [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E042 | RollbackTransitionObject | rollback:return"];
    RW3 -> RESUME [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E043 | RollbackTransitionObject | rollback:return"];
    RW4 -> RESUME [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E044 | RollbackTransitionObject | rollback:return"];
    RW5 -> RESUME [color="#C95A5A", fontcolor="#C95A5A", style="solid", penwidth=2.0, tooltip="E045 | RollbackTransitionObject | rollback:return"];
    RESUME -> TG [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E046 | GateTransitionObject | gate:rejoin:time", label="回到时间门禁"];
    SUG -> DM [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E047 | DecisionTransitionObject | decision:advisory"];
    DM -> PAUSE [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E048 | DecisionTransitionObject | decision:advisory", label="Accept"];
    DM -> TG [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E049 | DecisionTransitionObject | decision:advisory", label="Reject"];
    CT -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E050 | MetaTransitionObject | meta:suggestion_ingress"];
    DE -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E051 | MetaTransitionObject | meta:suggestion_ingress"];
    FC -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E052 | MetaTransitionObject | meta:suggestion_ingress"];
    MT -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E053 | MetaTransitionObject | meta:suggestion_ingress"];
    VZ -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E054 | MetaTransitionObject | meta:suggestion_ingress"];
    WR -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E055 | MetaTransitionObject | meta:suggestion_ingress"];
    AD -> SUG [color="#7F8C8D", fontcolor="#7F8C8D", style="solid", penwidth=2.0, tooltip="E056 | MetaTransitionObject | meta:suggestion_ingress"];
    P5 -> D5 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E057 | DecisionTransitionObject | decision:dispatch"];
    D5 -> I5 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E058 | DecisionTransitionObject | decision:dispatch"];
    D5 -> S5 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E059 | DecisionTransitionObject | decision:dispatch"];
    D5 -> M5 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E060 | DecisionTransitionObject | decision:dispatch"];
    I5 -> W5 [color="#2AA198", fontcolor="#2AA198", style="solid", penwidth=2.0, tooltip="E061 | SyncTransitionObject | sync:join"];
    S5 -> W5 [color="#2AA198", fontcolor="#2AA198", style="solid", penwidth=2.0, tooltip="E062 | SyncTransitionObject | sync:join"];
    M5 -> W5 [color="#2AA198", fontcolor="#2AA198", style="solid", penwidth=2.0, tooltip="E063 | SyncTransitionObject | sync:join"];
    W5 -> P55 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E064 | ProgressTransitionObject | progress:released"];
    P5 -> EM [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E065 | DecisionTransitionObject | decision:emergency"];
    EM -> BP [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E066 | ExceptionTransitionObject | exception:bypass", label="Yes"];
    BP -> P5 [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E067 | LoopTransitionObject | loop:generic", label="回到训练"];
    EM -> D5 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E068 | DecisionTransitionObject | decision:dispatch", label="No"];
    P65 -> APC [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E069 | GateTransitionObject | gate:entry:asset"];
    APC -> VFIX [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E070 | ExceptionTransitionObject | exception:block", label="No"];
    VFIX -> APC [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E071 | LoopTransitionObject | loop:fix", label="循环"];
    APC -> P7A [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E072 | ProgressTransitionObject | progress:released", label="Yes"];
    P7A -> EDR [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E073 | GateTransitionObject | gate:entry:editor_review"];
    P7B -> EDR [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E074 | GateTransitionObject | gate:entry:editor_review"];
    P7C -> EDR [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E075 | GateTransitionObject | gate:entry:editor_review"];
    P7D -> EDR [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E076 | GateTransitionObject | gate:entry:editor_review"];
    P7E -> EDR [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E077 | GateTransitionObject | gate:entry:editor_review"];
    EDR -> WREV [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E078 | ExceptionTransitionObject | exception:block", label="No"];
    WREV -> EDR [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E079 | LoopTransitionObject | loop:revision", label="重复审查"];
    P7F -> CMP [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E080 | GateTransitionObject | gate:entry:compile"];
    CMP -> RET [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E081 | ExceptionTransitionObject | exception:block", label="No, 可修复"];
    RET -> CMP [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E082 | LoopTransitionObject | loop:retry"];
    CMP -> ESC [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E083 | ExceptionTransitionObject | exception:escalation", label="No, 环境问题"];
    ESC -> CMP [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E084 | LoopTransitionObject | loop:generic"];
    CMP -> P75 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E085 | ProgressTransitionObject | progress:released", label="Yes"];
    P75 -> DC [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E086 | GateTransitionObject | gate:entry:data_consistency"];
    DC -> FIX [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E087 | ExceptionTransitionObject | exception:block", label="No"];
    FIX -> P75 [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E088 | LoopTransitionObject | loop:fix", label="循环"];
    DC -> P8 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E089 | ProgressTransitionObject | progress:released", label="Yes"];
    P91 -> DEF [color="#D39B2A", fontcolor="#D39B2A", style="solid", penwidth=2.0, tooltip="E090 | GateTransitionObject | gate:entry:mock_judging"];
    DEF -> RJ [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E091 | ExceptionTransitionObject | exception:block", label="Yes(自动拒绝)"];
    RJ -> P91 [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E092 | LoopTransitionObject | loop:generic"];
    DEF -> J1 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E093 | DecisionTransitionObject | decision:judging", label="No"];
    J1 -> RJ [color="#B22222", fontcolor="#B22222", style="solid", penwidth=2.0, tooltip="E094 | ExceptionTransitionObject | exception:block", label="Yes"];
    J1 -> J2 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E095 | DecisionTransitionObject | decision:judging", label="No"];
    J2 -> PP [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E096 | ProgressTransitionObject | progress:released", label="Yes"];
    PP -> P95 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E097 | ProgressTransitionObject | progress:linear"];
    J2 -> J3 [color="#8D6AC8", fontcolor="#8D6AC8", style="solid", penwidth=2.0, tooltip="E098 | DecisionTransitionObject | decision:judging", label="No"];
    J3 -> FP [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E099 | ProgressTransitionObject | progress:released", label="Yes"];
    FP -> P95 [color="#2E8B57", fontcolor="#2E8B57", style="solid", penwidth=2.0, tooltip="E100 | ProgressTransitionObject | progress:linear"];
    J3 -> RJ [color="#1F77B4", fontcolor="#1F77B4", style="solid", penwidth=2.0, tooltip="E101 | LoopTransitionObject | loop:reject_cycle", label="No"];
    P0 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E102 | GateTransitionObject | gate:hook:time"];
    P01 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E103 | GateTransitionObject | gate:hook:time"];
    P02 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E104 | GateTransitionObject | gate:hook:time"];
    P05 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E105 | GateTransitionObject | gate:hook:time"];
    P1 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E106 | GateTransitionObject | gate:hook:time"];
    P15 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E107 | GateTransitionObject | gate:hook:time"];
    P2 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E108 | GateTransitionObject | gate:hook:time"];
    P3 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E109 | GateTransitionObject | gate:hook:time"];
    P4 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E110 | GateTransitionObject | gate:hook:time"];
    P45 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E111 | GateTransitionObject | gate:hook:time"];
    P5 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E112 | GateTransitionObject | gate:hook:time"];
    P55 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E113 | GateTransitionObject | gate:hook:time"];
    P58 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E114 | GateTransitionObject | gate:hook:time"];
    P6 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E115 | GateTransitionObject | gate:hook:time"];
    P65 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E116 | GateTransitionObject | gate:hook:time"];
    P7A -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E117 | GateTransitionObject | gate:hook:time"];
    P7B -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E118 | GateTransitionObject | gate:hook:time"];
    P7C -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E119 | GateTransitionObject | gate:hook:time"];
    P7D -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E120 | GateTransitionObject | gate:hook:time"];
    P7E -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E121 | GateTransitionObject | gate:hook:time"];
    P7F -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E122 | GateTransitionObject | gate:hook:time"];
    P75 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E123 | GateTransitionObject | gate:hook:time"];
    P8 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E124 | GateTransitionObject | gate:hook:time"];
    P9 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E125 | GateTransitionObject | gate:hook:time"];
    P91 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E126 | GateTransitionObject | gate:hook:time"];
    P95 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E127 | GateTransitionObject | gate:hook:time"];
    P10 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E128 | GateTransitionObject | gate:hook:time"];
    P11 -> TG [color="#D39B2A", fontcolor="#D39B2A", style="dotted", penwidth=2.0, tooltip="E129 | GateTransitionObject | gate:hook:time"];
    NOTE -> P0 [color="#7F8C8D", fontcolor="#7F8C8D", style="dashed", penwidth=2.0, tooltip="E130 | MetaTransitionObject | meta:annotation", arrowhead=none];
    TG -> TV_CALL [color="#D39B2A", fontcolor="#D39B2A", style="dashed", penwidth=2.0, tooltip="E131 | GateTransitionObject | gate:handoff:time_validator", label="per-phase validation"];
    RR -> RERUN_CMD [color="#1F77B4", fontcolor="#1F77B4", style="dashed", penwidth=2.0, tooltip="E132 | LoopTransitionObject | loop:rerun", label="--rerun"];
    RERUN_CMD -> PREV_OUT [color="#2AA198", fontcolor="#2AA198", style="dashed", penwidth=2.0, tooltip="E133 | SyncTransitionObject | sync:dependency", label="read previous_output"];
    TIMEOUT3 -> ALT [color="#B22222", fontcolor="#B22222", style="dashed", penwidth=2.0, tooltip="E134 | ExceptionTransitionObject | exception:escalation", label="3x timeout"];
    ALT -> SIMPLE [color="#2E8B57", fontcolor="#2E8B57", style="dashed", penwidth=2.0, tooltip="E135 | ProgressTransitionObject | progress:linear", label="fallback"];
    SIMPLE -> CHUNK [color="#2E8B57", fontcolor="#2E8B57", style="dashed", penwidth=2.0, tooltip="E136 | ProgressTransitionObject | progress:linear", label="fallback"];
    ANY_PHASE -> KNOWN_ISSUES [color="#7F8C8D", fontcolor="#7F8C8D", style="dashed", penwidth=2.0, tooltip="E137 | MetaTransitionObject | meta:annotation", label="log issue"];
    KNOWN_ISSUES -> CONT [color="#2E8B57", fontcolor="#2E8B57", style="dashed", penwidth=2.0, tooltip="E138 | ProgressTransitionObject | progress:continued", label="workaround+continue"];
    P7F -> MANIFEST7 [color="#2AA198", fontcolor="#2AA198", style="dashed", penwidth=2.0, tooltip="E139 | SyncTransitionObject | sync:dependency", label="update VERSION_MANIFEST"];
    W5 -> ARTIFACT_CHECK [color="#D39B2A", fontcolor="#D39B2A", style="dashed", penwidth=2.0, tooltip="E140 | GateTransitionObject | gate:entry:data_consistency", label="results_i.csv exists?"];
    ARTIFACT_CHECK -> P55 [color="#2E8B57", fontcolor="#2E8B57", style="dashed", penwidth=2.0, tooltip="E141 | ProgressTransitionObject | progress:released", label="all present"];
    CONT -> CONSULT [color="#8D6AC8", fontcolor="#8D6AC8", style="dashed", penwidth=2.0, tooltip="E142 | DecisionTransitionObject | decision:advisory", label="consultation checkpoint"];
    AGENT_RUN -> TOOL_AUDIT [color="#D39B2A", fontcolor="#D39B2A", style="dashed", penwidth=2.0, tooltip="E143 | GateTransitionObject | gate:entry:quality", label="0 tool uses?"];
    DIRECTOR -> FILE_BAN [color="#B22222", fontcolor="#B22222", style="dashed", penwidth=2.0, tooltip="E144 | ExceptionTransitionObject | exception:block", label="read-ban enforcement"];
    EXT_RES -> TRUST_VERIFY [color="#D39B2A", fontcolor="#D39B2A", style="dashed", penwidth=2.0, tooltip="E145 | GateTransitionObject | gate:entry:quality", label="must verify independently"];
    REWORK_DONE -> REVERIFY_ALL [color="#D39B2A", fontcolor="#D39B2A", style="dashed", penwidth=2.0, tooltip="E146 | GateTransitionObject | gate:handoff:generic", label="all agents re-verify"];

    subgraph cluster_legend {
        label="V2 Primary Class Color Legend";
        style="rounded,dashed";
        color="#999999";
        LEG_P [label="ProgressTransitionObject", shape=plaintext, fontcolor="#2E8B57"];
        LEG_G [label="GateTransitionObject", shape=plaintext, fontcolor="#D39B2A"];
        LEG_D [label="DecisionTransitionObject", shape=plaintext, fontcolor="#8D6AC8"];
        LEG_R [label="RollbackTransitionObject", shape=plaintext, fontcolor="#C95A5A"];
        LEG_L [label="LoopTransitionObject", shape=plaintext, fontcolor="#1F77B4"];
        LEG_E [label="ExceptionTransitionObject", shape=plaintext, fontcolor="#B22222"];
        LEG_S [label="SyncTransitionObject", shape=plaintext, fontcolor="#2AA198"];
        LEG_M [label="MetaTransitionObject", shape=plaintext, fontcolor="#7F8C8D"];
    }
}
